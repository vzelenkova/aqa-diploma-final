# План автоматизации

## Цель

Автоматизировать позитивные и негативные сценарии покупки тура через дебетовую карту и кредит.

## Автоматизируемые сценарии

### UI-тесты (Selenide)
1. Успешная оплата по карте.
2. Оплата по карте с невалидным номером.
3. Оплата по карте с истекшим сроком действия.
4. Оплата по карте с неверным CVC.
5. Успешный кредит по карте.
6. Кредит по карте с невалидными данными.
7. Кредит по карте с истекшим сроком.
8. Кредит по карте с неверным CVC.
9. Проверка отображения сообщений об ошибках.
10. Проверка отображения успешного завершения.

### API-тесты (RestAssured)
11. Успешная оплата по карте → статус APPROVED, запись в БД.
12. Оплата по карте с невалидным номером → DECLINED, запись в БД.
13. Успешный кредит → APPROVED, запись в БД.
14. Кредит с невалидной картой → DECLINED, запись в БД.
15. Пустое тело запроса → 400 Bad Request.
16. Некорректный номер карты → 400 Bad Request.

### Проверки БД (JDBC)
17. Проверка записи успешной оплаты в `payment_entity`.
18. Проверка записи неудачной оплаты в `payment_entity`.
19. Проверка записи успешного кредита в `credit_request_entity`.
20. Проверка записи неудачного кредита в `credit_request_entity`.
21. Проверка связи `payment_entity` ↔ `order_entity`.
22. Проверка связи `credit_request_entity` ↔ `order_entity`.

## Инструменты

| Инструмент         | Обоснование                                        |
|--------------------|----------------------------------------------------|
| **Selenide**       | Простой и стабильный фреймворк для UI-тестов.      |
| **JUnit 5**        | Современный фреймворк для написания тестов.        |
| **RestAssured**    | Лучший выбор для API-тестирования в Java.          |
| **Allure**         | Генерация красивых отчётов с шагами и скриншотами. |
| **Gradle**         | Сборка и управление зависимостями.                 |
| **Docker Compose** | Запуск окружения (MySQL, PostgreSQL, эмулятор).    |
| **TestContainers** | Изоляция БД в тестах (опционально).                |

## Риски

| Риск                                  | Описание                                      | Мера снижения                                                           |
|---------------------------------------|-----------------------------------------------|-------------------------------------------------------------------------|
| Задержки запуска сервисов             | SUT или БД не успевают подняться.             | Добавим `sleep 30` перед тестами.                                       |
| Несоответствие эмулятора реальным API | Тесты могут падать из-за неожиданных ответов. | Используем предопределённые ответы из `data.json`.                      |
| Баги в приложении                     | Тесты будут падать, если найдут дефекты.      | Это ожидаемо — тесты должны падать при багах.                           |
| Проблемы с ChromeDriver               | Версия Chrome может не совпадать с Selenium.  | Используем `WebDriverManager` для автоматического управления драйвером. |

## Оценка времени

| Этап                | Планируемое время | Фактическое время |
|---------------------|-------------------|-------------------|
| Планирование        | 3 дня             | 3 дня             |
| Написание тестов    | 7 дней            | 8 дней            |
| Отладка и доработка | 3 дня             | 4 дня             |
| Подготовка отчётов  | 2 дня             | 2 дня             |
| **ИТОГО**           | **15 дней**       | **17 дней**       |

## План сдачи

- **День 3**: отправка плана руководителю.
- **День 10**: готовность автотестов.
- **День 14**: прогоны, баг-репорты, отчёты.
- **День 17**: финальная сдача.



